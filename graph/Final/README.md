# A. Железные дороги

В стране X есть n городов, которым присвоены номера от 1 до n. Столица страны имеет номер n. Между городами проложены железные дороги. Однако дороги могут быть двух типов по ширине полотна. Любой поезд может ездить только по одному типу полотна. Условно один тип дорог помечают как R, их строил король Ричардус, а другой как B, их строил его сын Барталамеус. То есть если маршрут от одного города до другого имеет как дороги типа R, так и дороги типа B, то ни один поезд не сможет по этому маршруту проехать. От одного города до другого можно проехать только по маршруту, состоящему исключительно из дорог типа R или только из дорог типа B.
Дороги страны X обладают еще и той особенностью, что по ним можно двигаться лишь от города с меньшим номером к городу с бОльшим номером. Это объясняет большой приток жителей в столицу, у которой номер n.
Карта железных дорог называется оптимальной, если не существует пары городов A и B такой, что от A до B можно добраться как по дорогам типа R, так и по дорогам типа B. Иными словами, для любой пары городов верно, что от города с меньшим номером до города с бОльшим номером можно добраться по дорогам только какого-то одного типа или же что маршрут построить вообще нельзя. Выясните, является ли данная вам карта оптимальной.

Пример 1

Ввод
3
RB
R
Вывод
NO

Пример 2

Ввод
4
BBB
RB
B
Вывод
YES

Пример 3

Ввод
5
RRRB
BRR
BR
R
Вывод
NO


# B. Путь по компонентам *

Задача повышенной сложности
Вам дан неориентированный граф. В каждой вершине графа записано по числу. В вершине i записано ai (1 ≤ ai ≤ 1000). В графе нашли компоненты реберной двусвязности, сжали их и получили одно или несколько деревьев. У каждой вершины сжатого графа тоже есть вес, который равен сумме весов исходной компоненты реберной двусвязности. В полученном графе найдите самый длинный путь, на котором веса вершин идут строго по возрастанию.
Иллюстрация второго примера:
123png

Пример 1
ВВОД
6 7
2 2 6 10 7 8
1 2
2 3
1 3
3 5
5 6
5 6
3 4
ВЫВОД
10 10 15 
2

Пример 2
ВВОД
7 8
2 2 2 4 4 4 3
1 2
2 3
1 3
4 5
5 6
4 6
3 5
3 7
ВЫВОД
3 6 12 
3


# С. Кондратиев остов

Кондратий уже сжег все мосты и поменял систему ценностей. Поэтому его теперь интересуют не минимальные, а максимальные остовные деревья. Он поручил вам найти вес такого максимального остовного дерева в неориентированном графе.


Пример 1
4 4
1 2 5
1 3 6
2 4 8
3 4 3
Вывод
19
